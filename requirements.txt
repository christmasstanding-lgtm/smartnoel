gradio
import json
from datetime import datetime
from collections import Counter

def generer_bilan():
    try:
        with open("data.json", "r", encoding="utf-8") as f:
            data = json.load(f)
    except FileNotFoundError:
        print("Aucune donnÃ©e trouvÃ©e.")
        return

    if not data:
        print("Aucune interaction enregistrÃ©e.")
        return

    total = len(data)
    pays_counter = Counter([entry["pays"] for entry in data])
    cadeaux = sum(1 for entry in data if "cadeau" in entry["message"].lower())
    cartes = sum(1 for entry in data if "carte" in entry["message"].lower())
    paiements = sum(1 for entry in data if entry["paiement"] == "Oui")

    bilan = f"""
ğŸ„ Bilan annuel SmartNoÃ«l â€“ {datetime.utcnow().year}
Nombre total dâ€™interactions : {total}
Nombre de pays diffÃ©rents : {len(pays_counter)}
Pays les plus actifs : {pays_counter.most_common(3)}
Demandes de cadeaux : {cadeaux}
Demandes de cartes : {cartes}
Interactions avec lien de paiement : {paiements}
"""

    print(bilan)

if __name__ == "__main__":
    generer_bilan()
